```json

{:message_id=>"92bb262f-ff52-486a-9293-8d7c81e7accb", :receipt_handle=>"AQEBaZSN0/wKpjoqRJk+6R13cETJ4pwvxb+JUT8pGkdWyq9eAN6G5Q/wsLchuEfesLbBMTAYzG2Ccb2qGutOn7JVrRhHRDBF4IOwudxKQALo6G3iRLEBFOrUhHEWXyE9PdOhX1xz4nKAdQwD/9XqFmkdEpbYKwZMx9IqVQhNsDG1Ne0CiwSXMFFj5ZfnLYcp46t71WPt0nB8nwxTEGH/6f358U83WkB4CU9xguYoQXujsMHKYagDO5vNNoA5gcmhsSX3n/LgtVe8BxLR+/T3LTCS22uE1gIDy6AVzrxdOns8H1jygHtsS5lNoKncAEk1df5wSIj7URLtU2kQKazAwnkpXpOcf3+byc5nGwgtw8gqhJo+lNxrsqTxEJZ6O5FteoM3Li88eLie8503p/wbR8nNW5UE0fqdVJ72zzP9BXW1WUY=", :md5_of_body=>"8067fc4d0cb2ee4af8a34b60e810b259", :body=>"{\"metadata\":{\"context_type\":\"Course\",\"context_id\":\"126090000000000271\",\"context_account_id\":\"126090000000000194\",\"context_sis_source_id\":null,\"root_account_uuid\":\"l75gZRO5smkKkgr5nl0vrCUnE5yIL9S0yV2lHSTG\",\"root_account_id\":\"126090000000000001\",\"root_account_lti_guid\":\"l75gZRO5smkKkgr5nl0vrCUnE5yIL9S0yV2lHSTG:canvas-lms\",\"user_login\":\"chris\",\"user_account_id\":\"126090000000000001\",\"user_sis_id\":null,\"user_id\":\"126090000000000126\",\"time_zone\":\"America/Chicago\",\"context_role\":\"StudentEnrollment\",\"request_id\":\"0da4394a-6a7e-4cd7-bcdb-288efdd8e468\",\"session_id\":\"e1f84c7ce25e1e5669e986f396979037\",\"hostname\":\"lozano.instructure.com\",\"http_method\":\"GET\",\"user_agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\"client_ip\":\"69.254.32.51\",\"url\":\"https://lozano.instructure.com/courses/271\",\"referrer\":\"https://lozano.catalog.instructure.com/\",\"producer\":\"canvas\",\"event_name\":\"enrollment_state_updated\",\"event_time\":\"2023-03-30T18:37:31.316Z\"},\"body\":{\"enrollment_id\":\"126090000000000708\",\"state\":\"active\",\"state_is_current\":true,\"restricted_access\":false,\"access_is_current\":true}}", :attributes=>{"SenderId"=>"AROAJGKQNN7U4U736W4YE:live-events-publish-prod_iad-publisher-lambda", "ApproximateFirstReceiveTimestamp"=>"1680201452327", "ApproximateReceiveCount"=>"1", "SentTimestamp"=>"1680201451996", "AWSTraceHeader"=>"Root=1-6425cb3c-6c1c6d222d3de623f14699ab;Parent=afa7d64d99ca19a0;Sampled=0"}, :md5_of_message_attributes=>"d94b7182c6c0c577ef32187ff44340a8", :message_attributes=>{"account_id"=>{:string_value=>"126090000000000001", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}, "account_uuid"=>{:string_value=>"l75gZRO5smkKkgr5nl0vrCUnE5yIL9S0yV2lHSTG", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}, "event_name"=>{:string_value=>"enrollment_state_updated", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}, "event_time"=>{:string_value=>"2023-03-30T18:37:31.316Z", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}}}

```


```json
   message: {:message_id=>"0dc7ab37-5c80-4c29-8e8f-c28cf07f2040", :receipt_handle=>"AQEByca4GkBLyLywYvg+fuhASADwewHiIeRvvE/A2LzcW/DM1ftYpo1529VGd/dRFTAK956XB2f+LsiT3viqbyK2aT61ysh5Kf1qbJIOiPWdelYilQzFXZmcHwATVVkIIEmZs2JUoeUVehn/4HYI8EkfUItVj1LMBTdjtd0o/4QdyMTmnGAj9/CSdL54+vgTEetEVSGlFVrYS6rIeB6CGbk/Ta5YdCJ6Y+h5Lm07+511cKgAlUBP1snb8JHZHf0JfslTmkC8NvN9HLM9WOqiZi7AWUWvJQ/K+k4UwFUqM8mb5vcwiJnbz0Zphz/jZy8PJdWMsGOZYpgdeSK0CL+U8iDu0meKop1ObiB4vcmOOnY8FPwg65F7gKSyvlTHL3KLgqJ5bvMnwu2v1rVbeBEcc9/vPoIhH2k9s33cwAMlfYvUVSE=", :md5_of_body=>"2c3a0792c9c3920b18a2c6011e2e901e", :body=>"{\"metadata\":{\"context_type\":\"Course\",\"context_id\":\"126090000000000271\",\"context_account_id\":\"126090000000000194\",\"context_sis_source_id\":null,\"root_account_uuid\":\"l75gZRO5smkKkgr5nl0vrCUnE5yIL9S0yV2lHSTG\",\"root_account_id\":\"126090000000000001\",\"root_account_lti_guid\":\"l75gZRO5smkKkgr5nl0vrCUnE5yIL9S0yV2lHSTG:canvas-lms\",\"user_login\":\"chris\",\"user_account_id\":\"126090000000000001\",\"user_sis_id\":null,\"user_id\":\"126090000000000126\",\"time_zone\":\"America/Chicago\",\"context_role\":\"StudentEnrollment\",\"request_id\":\"ccbb6698-b1ba-4df5-b50a-f99fde48f74d\",\"session_id\":\"bcfccdd9f45ef0a13643e1b2e870d5bf\",\"hostname\":\"lozano.instructure.com\",\"http_method\":\"POST\",\"user_agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\"client_ip\":\"69.254.32.51\",\"url\":\"https://lozano.instructure.com/courses/271/self_unenrollment/tianIUuuitKNGkUcabNZs9dv5VytcvJjjt4A1DMb\",\"referrer\":\"https://lozano.instructure.com/courses/271\",\"producer\":\"canvas\",\"event_name\":\"enrollment_state_updated\",\"event_time\":\"2023-03-30T16:27:54.811Z\"},\"body\":{\"enrollment_id\":\"126090000000000708\",\"state\":\"completed\",\"state_is_current\":true,\"restricted_access\":false,\"access_is_current\":true}}", :attributes=>{"SenderId"=>"AROAJGKQNN7U4U736W4YE:live-events-publish-prod_iad-publisher-lambda", "ApproximateFirstReceiveTimestamp"=>"1680193677770", "ApproximateReceiveCount"=>"1", "SentTimestamp"=>"1680193675192", "AWSTraceHeader"=>"Root=1-6425b88b-32625ed0c88cc73114ac9226;Parent=759b3411b59dac4d;Sampled=0"}, :md5_of_message_attributes=>"99faac86f3adf0e74a71cceff36a0996", :message_attributes=>{"account_id"=>{:string_value=>"126090000000000001", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}, "account_uuid"=>{:string_value=>"l75gZRO5smkKkgr5nl0vrCUnE5yIL9S0yV2lHSTG", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}, "event_name"=>{:string_value=>"enrollment_state_updated", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}, "event_time"=>{:string_value=>"2023-03-30T16:27:54.811Z", :binary_value=>nil, :string_list_values=>[], :binary_list_values=>[], :data_type=>"String"}}}
 ```

The problem was that the user could not re enroll after this.

The conclusion was that this is currently the expected behaviour:
https://instructure.atlassian.net/browse/PHO-340
As the enrollment on canvas side stays in a completed state.
Re enrolling would result in an error.